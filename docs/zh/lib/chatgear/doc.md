# chatgear

## 概述
chatgear 定义了设备到服务器通信的核心协议类型：命令、状态事件、统计数据和音频流元数据。它专注于接口设计而非传输实现，并提供用于测试的进程内管道。

## 设计目标
- 设备状态和控制的稳定类型化协议
- 上行链路（设备 -> 服务器）和下行链路（服务器 -> 设备）的清晰分离
- 时间戳和命令发布的显式元数据
- 带有 Opus 帧时间戳的音频流
- Go 和 Rust 支持相似的 API 表面

## 关键概念
- **会话命令**：带有类型化载荷的设备控制命令
- **状态事件**：带有原因的设备状态转换
- **统计事件**：遥测快照和增量变化
- **上行/下行**：双向流的分离接口
- **端口**：更高级别的客户端/服务器端口抽象

## 子模块
- `transport`：上行/下行连接 trait 和管道辅助函数
- `port`：客户端/服务器端口 trait 和音频轨道控制

## 外部参考
- `/Users/idy/Work/haivivi/x/docs/chatgear`（原始协议/设计笔记）

## 相关模块
- `docs/lib/audio/opusrt` 用于 Opus 帧处理
- `docs/lib/jsontime` 用于毫秒时间戳
